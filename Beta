from datetime import datetime
import PySimpleGUI as sg


horaAtual = float(datetime.now().strftime('%H.%M'))
cod = ['1', '2']

if horaAtual > 8.50 and horaAtual < 21.10:
    def first_screen():
        layout = [
            [sg.Text('Codigo:'), sg.Input(key='COD')],
            [sg.Button('Enviar', key='ENV')]
        ]
        return sg.Window('One Point', layout=layout, finalize=True,
        resizable=True, return_keyboard_events=True)
    
    win1, win2 = first_screen(), None
    while True:
        window, event, value = sg.read_all_windows()
        if window == win1 and event == sg.WIN_CLOSED:
            break
        if window == win1 and event == 'ENV':
            if value['COD'] in cod:
                sg.popup('Ponto Registrado')
                window.FindElement('COD').Update('')

elif horaAtual < 8.50 or horaAtual > 21.10:
    sg.popup('Fora da hora de funcionamento')
